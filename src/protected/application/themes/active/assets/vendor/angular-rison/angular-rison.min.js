/*! angular-rison - v0.0.12 - 2013-09-20 */!function(exports,global){global["true"]=exports,angular.module("rison",[]).factory("$rison",[function(){var publicMembers={},privateMembers={};return privateMembers.not_idchar=" '!:(),*@$",privateMembers.not_idstart="-0123456789",privateMembers.idRegularExpression="[^"+privateMembers.not_idstart+privateMembers.not_idchar+"][^"+privateMembers.not_idchar+"]*",privateMembers.id_ok=new RegExp("^"+privateMembers.idRegularExpression+"$"),privateMembers.next_id=new RegExp(privateMembers.idRegularExpression,"g"),privateMembers.sq={"'":!0,"!":!0},function(){var sq={"'":!0,"!":!0},s={array:function(x){var b,f,i,v,a=["!("],l=x.length;for(i=0;l>i;i+=1)v=x[i],f=s[typeof v],f&&(v=f(v),"string"==typeof v&&(b&&(a[a.length]=","),a[a.length]=v,b=!0));return a[a.length]=")",a.join("")},"boolean":function(x){return x?"!t":"!f"},"null":function(){return"!n"},number:function(x){return isFinite(x)?String(x).replace(/\+/,""):"!n"},object:function(x){if(x){if(x instanceof Array)return s.array(x);if("object"==typeof x.__prototype__&&"undefined"!=typeof x.__prototype__.encode_rison)return x.encode_rison();var b,f,i,v,ki,a=["("],ks=[];for(i in x)ks[ks.length]=i;for(ks.sort(),ki=0;ki<ks.length;ki++)i=ks[ki],v=x[i],f=s[typeof v],f&&(v=f(v),"string"==typeof v&&(b&&(a[a.length]=","),a.push(s.string(i),":",v),b=!0));return a[a.length]=")",a.join("")}return"!n"},string:function(x){return""===x?"''":privateMembers.id_ok.test(x)?x:(x=x.replace(/(['!])/g,function(a,b){return sq[b]?"!"+b:b}),"'"+x+"'")},undefined:function(){throw new Error("rison can't encode the undefined value")}};publicMembers.stringify=function(object){return s[typeof object](object)}}(),publicMembers.parse=function(r){var errcb=function(e){throw Error("rison decoder error: "+e)},p=new privateMembers.parser(errcb);return p.parse(r)},privateMembers.parser=function(errcb){this.errorHandler=errcb},privateMembers.parser.WHITESPACE="",privateMembers.parser.prototype.setOptions=function(options){options.errorHandler&&(this.errorHandler=options.errorHandler)},privateMembers.parser.prototype.parse=function(str){this.string=str,this.index=0,this.message=null;var value=this.readValue();return!this.message&&this.next()&&(value=this.error("unable to parse string as rison: '"+publicMembers.encode(str)+"'")),this.message&&this.errorHandler&&this.errorHandler(this.message,this.index),value},privateMembers.parser.prototype.error=function(message){return"undefined"!=typeof console&&console.error("Rison parser error: ",message),this.message=message,void 0},privateMembers.parser.prototype.readValue=function(){var c=this.next(),fn=c&&this.table[c];if(fn)return fn.apply(this);var s=this.string,i=this.index-1;privateMembers.next_id.lastIndex=i;var m=privateMembers.next_id.exec(s);if(m.length>0){var id=m[0];return this.index=i+id.length,id}return c?this.error("invalid character: '"+c+"'"):this.error("empty expression")},privateMembers.parser.parse_array=function(parser){for(var c,ar=[];")"!=(c=parser.next());){if(!c)return parser.error("unmatched '!('");if(ar.length)","!=c&&parser.error("missing ','");else{if(","==c)return parser.error("extra ','");--parser.index}var n=parser.readValue();if("undefined"==typeof n)return void 0;ar.push(n)}return ar},privateMembers.parser.bangs={t:!0,f:!1,n:null,"(":privateMembers.parser.parse_array},privateMembers.parser.prototype.table={"!":function(){var s=this.string,c=s.charAt(this.index++);if(!c)return this.error('"!" at end of input');var x=privateMembers.parser.bangs[c];return"function"==typeof x?x.call(null,this):"undefined"==typeof x?this.error('unknown literal: "!'+c+'"'):x},"(":function(){for(var c,o={},count=0;")"!=(c=this.next());){if(count)","!=c&&this.error("missing ','");else{if(","==c)return this.error("extra ','");--this.index}var k=this.readValue();if("undefined"==typeof k)return void 0;if(":"!=this.next())return this.error("missing ':'");var v=this.readValue();if("undefined"==typeof v)return void 0;o[k]=v,count++}return o},"'":function(){for(var c,s=this.string,i=this.index,start=i,segments=[];"'"!=(c=s.charAt(i++));){if(!c)return this.error('unmatched "\'"');if("!"==c){if(i-1>start&&segments.push(s.slice(start,i-1)),c=s.charAt(i++),!("!'".indexOf(c)>=0))return this.error('invalid string escape: "!'+c+'"');segments.push(c),start=i}}return i-1>start&&segments.push(s.slice(start,i-1)),this.index=i,1==segments.length?segments[0]:segments.join("")},"-":function(){var s=this.string,i=this.index,start=i-1,state="int",permittedSigns="-",transitions={"int+.":"frac","int+e":"exp","frac+e":"exp"};do{var c=s.charAt(i++);if(!c)break;c>="0"&&"9">=c||(permittedSigns.indexOf(c)>=0?permittedSigns="":(state=transitions[state+"+"+c.toLowerCase()],"exp"==state&&(permittedSigns="-")))}while(state);return this.index=--i,s=s.slice(start,i),"-"==s?this.error("invalid number"):Number(s)}},function(table){for(var i=0;9>=i;i++)table[String(i)]=table["-"]}(privateMembers.parser.prototype.table),privateMembers.parser.prototype.next=function(){var c,s=this.string,i=this.index;do{if(i==s.length)return void 0;c=s.charAt(i++)}while(privateMembers.parser.WHITESPACE.indexOf(c)>=0);return this.index=i,c},publicMembers}])}({},function(){return this}());
//# sourceMappingURL=angular-rison.map
